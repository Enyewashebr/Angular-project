<div class="card" *ngIf="vm$ | async as vm">
  <h2>Reports</h2>

  <div class="stats">
    <div class="stat">
      <div class="label">Today Sales</div>
      <div class="value">${{ vm.totalToday | number:'1.2-2' }}</div>
    </div>
    <div class="stat">
      <div class="label">This Month Sales</div>
      <div class="value">${{ vm.totalThisMonth | number:'1.2-2' }}</div>
    </div>
    <div class="stat">
      <div class="label">This Year Sales</div>
      <div class="value">${{ vm.totalThisYear | number:'1.2-2' }}</div>
    </div>
  </div>

  <div class="grid">
    <div class="panel">
      <h3>Daily Sales (Current Month)</h3>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Orders</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let d of vm.daily">
            <td>{{ d.day }}</td>
            <td>{{ d.orders }}</td>
            <td>${{ d.total | number:'1.2-2' }}</td>
          </tr>
          <tr *ngIf="!vm.daily.length">
            <td colspan="3" class="muted">No orders in current month.</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="panel">
      <h3>Monthly Sales (Current Year)</h3>
      <table>
        <thead>
          <tr>
            <th>Month</th>
            <th>Orders</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let m of vm.monthly">
            <td>{{ m.month }}</td>
            <td>{{ m.orders }}</td>
            <td>${{ m.total | number:'1.2-2' }}</td>
          </tr>
          <tr *ngIf="!vm.monthly.length">
            <td colspan="3" class="muted">No orders in current year.</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="panel" style="grid-column: 1 / -1;">
      <h3>Top Sold Products</h3>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Product</th>
            <th>Qty Sold</th>
            <th>Revenue</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of vm.topProducts; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ p.productName }}</td>
            <td>{{ p.qty }}</td>
            <td>${{ p.revenue | number:'1.2-2' }}</td>
          </tr>
          <tr *ngIf="!vm.topProducts.length">
            <td colspan="4" class="muted">No sales yet.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
